input←(2⊃⎕VFI)¨⊃⎕NGET 'input.txt' 1

⎕←+/   ∨⍥((1∧.≤⊢)∧(3∧.≥⊢))∘-⍨¨¯2-/¨input                        ⍝ part 1
⎕←+/{∨/∨⍥((1∧.≤⊢)∧(3∧.≥⊢))∘-⍨¨¯2-/¨(⊂⍵),↓⍵/⍨⍤1∘.≠⍨⍳≢⍵}¨input    ⍝ part 2

⍝ faster part 2
Safe←{
	i←⍸(1>⍵)∨(3<⍵)
	0=≢i: 1
	3≤≢i: 0
	2=≢i: {¯1=-/i: ((1≤⊢)∧(3≥⊢))+/⍵[i] ⋄ 0}⍵
	i←⊃i
	i∊1(≢⍵): 1
	∨/((1≤⊢)∧(3≥⊢))2+/⍵[¯1 0 1+i]
}
⎕←+/∨⍥Safe∘-⍨¨¯2-/¨input

⍝ 'cmpx' ⎕cy 'dfns'
⍝ cmpx '+/{∨/∨⍥((1∧.≤⊢)∧(3∧.≥⊢))∘-⍨¨¯2-/¨(⊂⍵),↓⍵/⍨⍤1∘.≠⍨⍳≢⍵}¨input' '+/∨⍥Safe∘-⍨¨¯2-/¨input'
