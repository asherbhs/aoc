linesâ†â€¢FLines "input.txt"
splitâ†âŠ‘linesâŠ<""
map  â†>    splitâ†‘lines
movesâ†âˆ¾(split+1)â†“lines

# part 1
{
	dâ†[
		[ 0,  1],
		[ 1,  0],
		[ 0, Â¯1],
		[Â¯1,  0],
	]
	wâ†[
		Â¯1+â‰¢map,
		Â¯1+â‰¢map,
		[0, 0],
		[0, 0],
	]
	mapâ†map
	râ†âŠ‘(â¥Š'@'=map)/â¥Šâ†•â‰¢map
	{
		dâ†ğ•©âŠd
		wâ†ğ•©âŠw
		iâ†(r+dÃ—âŠ¢)Â¨1+â†•|âŠ‘(dâ‰ 0)/dÃ·Ëœr-w
		pâ†iâŠ‘map
		oâ†âˆ§`'O'=p
		{ğ•Šğ•©:
			map'O'Â¨âŒ¾((i/ËœÂ»o)âŠ¸âŠ‘)â†©
			map'.'âŒ¾(râŠ¸âŠ‘)â†©
			r+â†©d
			map'@' âŒ¾(râŠ¸âŠ‘)â†©
		}âŸ('.'=pâŠ‘ËœâŠ‘oâŠ0)@
	}Â¨">v<^"âŠmoves
	â€¢Show +Â´(+Â´100â€¿1Ã—âŠ¢)Â¨(â¥Š'O'=map)/â¥Šâ†•â‰¢map
}

# part 2
{
	mapâ†(1â€¿2Ã—â‰¢map)â¥Š["##", "[]", "..", "@."]âŠËœ"#O.@"âŠmap
	râ†âŠ‘(â¥Š'@'=map)/â¥Šâ†•â‰¢map
	# couldn't be arsed to make this smaller
	{
		ğ•Š'>':
			iâ†râŠ¸+Â¨0âˆ¾Â¨1+â†•(Â¯1+1âŠ‘â‰¢map)-1âŠ‘r
			pâ†iâŠ‘map
			oâ†âˆ§`pâˆŠ"[]"
			{ğ•Šğ•©:
				map(o/mapâŠ‘Ëœi)âŒ¾((i/ËœÂ»o)âŠ¸âŠ‘)â†©
				map'.'âŒ¾(râŠ¸âŠ‘)â†©
				r+â†©0â€¿1
				map'@'âŒ¾(râŠ¸âŠ‘)â†©
			}âŸ('.'=pâŠ‘ËœâŠ‘oâŠ0)@
		;
		ğ•Š'v':
			bâ†â‹ˆr
			(â‹ˆr){
				iâ†(0âŠ‘r)+ğ•¨
				bbâ†1â€¿0âŠ¸+Â¨â¥Šâˆ¨Â´Ë˜âˆ˜âˆŠâŸœğ•©âŠ¸/(i-1)âˆ¾Â¨0â€¿1+âŒœËœ/'['=iâŠmap
				bâˆ¾â†©bb
				bb
			}Â´âŒ½1+â†•(Â¯1+0âŠ‘â‰¢map)-0âŠ‘r
			bbâ†1â€¿0âŠ¸+Â¨b
			{ğ•Šğ•©:
				r+â†©1â€¿0
				sâ†bâŠ‘map
				map'.'Â¨âŒ¾( bâŠ¸âŠ‘)â†©
				map   sâŒ¾(bbâŠ¸âŠ‘)â†©
			}âŸ(Â¬'#'âˆŠbbâŠ‘map)@
		;
		ğ•Š'<':
			iâ†râŠ¸-Â¨0âˆ¾Â¨1+â†•1âŠ‘r
			pâ†iâŠ‘map
			oâ†âˆ§`pâˆŠ"[]"
			{ğ•Šğ•©:
				map(o/mapâŠ‘Ëœi)âŒ¾((i/ËœÂ»o)âŠ¸âŠ‘)â†©
				map'.'âŒ¾(râŠ¸âŠ‘)â†©
				r+â†©0â€¿Â¯1
				map'@'âŒ¾(râŠ¸âŠ‘)â†©
			}âŸ('.'=pâŠ‘ËœâŠ‘oâŠ0)@
		;
		ğ•Š'^':
			bâ†â‹ˆr
			(â‹ˆr){
				iâ†(0âŠ‘r)-ğ•¨
				bbâ†Â¯1â€¿0âŠ¸+Â¨â¥Šâˆ¨Â´Ë˜âˆ˜âˆŠâŸœğ•©âŠ¸/(i+1)âˆ¾Â¨0â€¿1+âŒœËœ/'['=iâŠmap
				bâˆ¾â†©bb
				bb
			}Â´âŒ½1+â†•0âŠ‘r
			bbâ†Â¯1â€¿0âŠ¸+Â¨b
			{ğ•Šğ•©:
				r+â†©Â¯1â€¿0
				sâ†bâŠ‘map
				map'.'Â¨âŒ¾( bâŠ¸âŠ‘)â†©
				map   sâŒ¾(bbâŠ¸âŠ‘)â†©
			}âŸ(Â¬'#'âˆŠbbâŠ‘map)@
	}Â¨moves
	â€¢Show +Â´(+Â´100â€¿1Ã—âŠ¢)Â¨(â¥Š'['=map)/â¥Šâ†•â‰¢map
}
